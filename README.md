# ITMO_ML_HW

Car Faults: Multi-Task ML (classification + regression)

# Задача (Kaggle):
Каршеринг с большим автопарком. Регулярные осмотры важны, но ресурсы ограничены.
Цель — приоритизировать обход: кого смотреть раньше и какого типа поломку ожидать, чтобы правильно планировать бригады и оборудование.

предсказать для каждой машины:
	1.	тип поломки target_class (мультиклассовая классификация, 9 классов);
	2.	время до поломки target_reg (регрессия).

Соревнование: Competative Data Science Course by Data Feeling
Kaggle: https://www.kaggle.com/competitions/competative-data-science-course-by-data-feeling

# Данные
739 500 строк
# Главные таблицы:
	•	car_train.csv / car_test.csv — описание машины, таргеты:
	•	car_id, model, car_type, fuel_type, car_rating, riders,
year_to_start, year_to_work, main_city,
target_reg (время до поломки), target_class (тип поломки, 9 классf xов).

# Дополнительные таблицы:
	•	rides_info.csv — поездки (скорости, длительность, расстояние, стоимость, дозаправка, метрики вождения и т.п.).
	•	driver_info.csv — профиль водителя (пол, возраст, рейтинги, количество поездок, инциденты и т.д.).
	•	fix_info.csv — ремонты (тип работ, длительность, степень износа, дата ремонта).

⸻

# Бизнес-постановка

Каршеринговая компания с крупным автопарком стремится сократить простои машин и снизить расходы на внеплановый ремонт.
Необходимо построить модель, которая прогнозирует вероятность и тип поломки автомобиля на основе данных о поездках, водителях и предыдущих ремонтах.
Полученные прогнозы позволят сформировать приоритизированный список машин для технического осмотра, чтобы обслуживать в первую очередь автомобили с наибольшим риском выхода из строя.

# ML-постановка

Это мультиклассовая классификация, где целевая переменная target_class принимает одно из 9 значений (тип поломки).
Дополнительно может быть решена сопутствующая задача регрессии (target_reg) — прогноз времени до поломки, что позволит ранжировать машины по срочности.

# Основная метрика

Для решения задачи многоклассовой классификации типа поломки выбрана macro F1-мера.
Эта метрика усредняет F1-значения по всем классам, независимо от их частоты, что позволяет корректно оценивать качество модели при существенном дисбалансе классов (редкие типы поломок, например engine_overheat или electro_bug, не теряются на фоне частых).
Использование F1 также оправдано, так как для бизнеса важно не просто предсказать большинство частых классов, а сбалансировать  precision и recall — чтобы минимизировать как пропуски опасных поломок, так и ложные срабатывания.

# Дополнительные метрики
	•	Accuracy — для общей интерпретации, но не основная из-за дисбаланса.
	•	MAE  — при решении дополнительной задачи target_reg.

# Обоснование выбора
В задаче классификации типа поломки автомобилей используется macro F1-мера, так как данные содержат выраженный дисбаланс классов, и важно одинаково оценивать качество предсказаний как для частых, так и для редких категорий. Эта метрика позволяет сбалансировать точность и полноту, что критично при прогнозировании редких, но значимых неисправностей.

# Структура проекта

ITMO_ML_HW/
├─ data/
│  ├─ raw/                 # исходники с Kaggle 
│  ├─ external/            # при необходимости: сторонние источники
│  ├─ interim/             # временные и кэш-артефакты
│  └─ processed/           # финальные фичи/фолды для обучения
│
├─ notebooks/
│  ├─ 01_eda_overview.ipynb              # общий EDA по всем таблицам
│  ├─ 02_feature_aggs.ipynb              # прототип агрегаций по rides/driver/fix
│  ├─ 03_model_classification_baseline.ipynb
│  ├─ 04_model_regression_baseline.ipynb
│  
│
├─ src/
│  ├─ data/
│  │  ├─ load.py                         # единая загрузка CSV
│  │  ├─ merge.py                        # джоины и согласование ключей
│  │  └─ split.py                        # фолды (StratifiedKFold, TimeSplit и т.п.)
│  │
│  ├─ features/
│  │  ├─ make_features.py                # конвейер генерации фич (агрегаты, энкодинги)
│  │  └─ selectors.py                    # отбор фич, фильтрация коллинеарности
│  │
│  ├─ models/
│  │  ├─ train_cls.py                    # обучение классификации (target_class)
│  │  ├─ train_reg.py                    # обучение регрессии (target_reg)
│  │  ├─ infer_cls.py                    # инференс на test для класса
│  │  ├─ infer_reg.py                    # инференс на test для регрессии
│  │  └─ metrics.py                      # локальные метрики/метрики CV
│  │
│  ├─ utils/
│  │  ├─ io.py                           # сохранение/загрузка моделей и артефактов
│  │  ├─ logging.py                      # единый логгер
│  │  └─ seed.py                         # фиксация random_state
│  │
│  └─ pipelines/
│     └─ train_pipeline.py               # end-to-end: данные → фичи → обучение → валидация
│
├─ configs/
│  ├─ config_cls.yaml                    # гиперпараметры модели классификации, список фич
│  ├─ config_reg.yaml                    # гиперпараметры модели регрессии
│  └─ paths.yaml                         # все пути к данным/артефактам
│
├─ models/
│  ├─ cls/                               # сохранённые модели классификации, oof, импортансы
│  └─ reg/                               # сохранённые модели регрессии, oof
│
├─ reports/
│  ├─ figures/                           # графики EDA, важности фич, PR/ROC и т.д.
│  └─ tables/                            # сводные таблицы, метрики, сравнения
│
├─ submissions/                          # сабмиты для Kaggle
│
├─ requirements.txt
├─ README.md
└─ .gitignore



